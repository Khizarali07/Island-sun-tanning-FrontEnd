const calculateDaysLeft = (expirationDate) => {
  const today = new Date();
  const expiration = new Date(expirationDate);
  const timeDifference = expiration.getTime() - today.getTime();
  const daysLeft = Math.ceil(timeDifference / (1000 * 3600 * 24));

  if (daysLeft > 0) {
    return `${daysLeft} day(s) left until expiration`;
  } else if (daysLeft === 0) {
    return "Package expires today";
  } else {
    return "Package expired";
  }
};

const renderPackages = () => {
  if (
    customer &&
    Array.isArray(customer.packages) &&
    customer.packages.length > 0
  ) {
    return customer.packages.map((pkg) => {
      console.log("Package:", pkg);
      return (
        <div key={pkg._id || Math.random()} className="package-card">
          {pkg.packageId ? (
            <>
              <h4 className="package-title">
                Package Name: {pkg.packageId.name || "N/A"}
              </h4>
              <p className="package-details">
                Remaining Redemptions:{" "}
                {pkg.packageId.isUnlimited
                  ? "Unlimited"
                  : pkg.remainingRedemptions}
              </p>
              <p className="package-expiration">
                Expiration Date:{" "}
                {pkg.expiration
                  ? calculateDaysLeft(pkg.expiration)
                  : "No expiration"}
              </p>
              <p className="package-assigned">
                Assigned on:{" "}
                {pkg.assignedDate
                  ? new Date(pkg.assignedDate).toLocaleDateString()
                  : "Unknown"}
              </p>
            </>
          ) : (
            <p>Package information not available</p>
          )}
        </div>
      );
    });
  }
  return <p>No packages found for this customer.</p>;
};

{
  customer && (
    <div className="customer-info">
      <h3 className="customer-found">Customer Found: {customer.name}</h3>
      <h4 className="packages-title">Your Packages</h4>
      {renderPackages()}
    </div>
  );
}
